<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      * {
        margin: 0;
        padding: 0;
      }
      a {
        text-decoration: none;
      }
      .container {
        width: 700px;
        box-sizing: border-box;
        margin: 0 auto;
        padding: 0 20px;
        background-color: rgb(231, 231, 231);
      }
      .tbody {
        display: flex;
        flex-direction: column;
      }
      h2 {
        padding: 15px 0;
        text-align: center;
      }
      .add-btn{
        width: 60px;
        height: 30px;
      }
      .add-ipt {
        width: 550px;
        height: 25px;
      }
      .taskbar {
        height: 40px;
        margin: 15px 15px 0;
        padding: 0 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        background-color: rgb(184, 184, 184);
      }
      .taskbar .taskName {
        width: 300px;
        height: 30px;
        font-size: 16px;
      }
      .hide {
        border-style: none;
        background: none;
      }
      .taskbar a {
        color: red;
        font-size: 14px;
        margin: 0 5px;
        visibility: hidden;
      }
      .taskbar:hover a {
        visibility: visible;
      }
      .select {
        height: 40px;
        line-height: 40px;
        margin: 15px 15px 0;
        padding: 0 15px;
      }
      .select a {
        color: blue;
        font-size: 14px;
        margin-right: 25px;
      }
      .tfoot {
        margin-top: 40px;
        padding-bottom:10px ;
      }
      .tfoot h2 {
        padding: 20px 0;
      }
      .complete_ipt{
        height: 40px;
        margin: 0 15px 10px;
        padding: 0 10px;
        color: rgb(136, 136, 136);
        display: flex;
        align-items: center;
        background-color: rgb(184, 184, 184);
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="tbody">
        <h2>待办任务列表</h2>
        <input type="text" class="add-ipt" />
        <input type="button" value="添加" class="add-btn"></input>
        <div class="taskList">
          <div class="taskbar">
            <div class="left">
              <input type="checkbox" class="checkBox"/>
              <input type="text" value="任务1" class="taskName hide" />
            </div>
            <div class="right">
              <a href="javascript:;" class="modify">编辑</a>
              <a href="javascript:;" class="delet">删除</a>
            </div>
          </div>
          <div class="taskbar">
            <div class="left">
              <input type="checkbox" class="checkBox"/>
              <input type="text" value="任务2" class="taskName hide" />
            </div>
            <div class="right">
              <a href="javascript:;" class="modify">编辑</a>
              <a href="javascript:;" class="delet">删除</a>
            </div>
          </div>
          <div class="taskbar">
            <div class="left">
              <input type="checkbox" class="checkBox"/>
              <input type="text" value="任务3" class="taskName hide" />
            </div>
            <div class="right">
              <a href="javascript:;" class="modify">编辑</a>
              <a href="javascript:;" class="delet">删除</a>
            </div>
          </div>
        </div>
        <div class="select">
          <input type="checkbox" class="select-btn"/>
          <a href="javascript:;">选择全部</a>
          <a href="javascript:;" class="complete">处理</a>
          <a href="javascript:;" class="select-dlt">删除</a>
        </div>
      </div>
      <div class="tfoot">
        <h2>已处理任务列表</h2>
      </div>
    </div>

    <script>
      let taskList = document.querySelector('.taskList');
      let taskbar = document.getElementsByClassName('taskbar');
      let checkBox = document.getElementsByClassName('checkBox')
      let taskName = document.getElementsByClassName('taskName');
      let modify = document.getElementsByClassName('modify');
      let dlt = document.getElementsByClassName('delet');
      let selectAll = document.querySelector('.select-btn')
      let add_ipt = document.querySelector('.add-ipt')
      let add_btn = document.querySelector('.add-btn')
      let complete = document.querySelector('.complete')
      let select_dlt = document.querySelector('.select-dlt')
      let completeList = document.querySelector('.tfoot')

      focus(taskName)
      // 添加任务
      add_btn.onclick = function(){
        if(add_ipt.value != ''){
          let newTaskbar = taskbar[0].cloneNode(true)
          taskList.appendChild(newTaskbar)
          taskName[taskList.children.length-1].value = add_ipt.value
          checkBox[taskList.children.length-1].checked = false
          add_ipt.value = ''
        }else{
          alert('请输入任务名噢~')
        }
        focus(taskName)
        isSelectAll()
      }

      // 修改taskbar
      taskList.onclick = function(e){
        for(let i = 0; i < taskbar.length; i++){
          // 删除taskbar
          if (e.target == dlt[i]) {
          // this.removeChild(taskbar[i])
          taskbar[i].style.display = 'none';
          }
          // 修改taskName
          if (e.target == modify[i]) {
            taskName[i].focus();
          }
          // 点击checkbox
          if(e.target == checkBox[i]){
            for(let i = 0;i<checkBox.length;i++){
              checkBox[i].onclick = isSelectAll
            }
          }
        }
      }
      // 删除taskbar
      select_dlt.onclick = function(){
        for(let i = 0; i < checkBox.length; i++){
          if(checkBox[i].checked){
            // taskList.removeChild(taskbar[i])
            taskbar[i].style.display = 'none';
          }
        }
      }

      // 设置全选
      selectAll.onclick = function(){
        console.log(1);
        for(let i = 0;i<checkBox.length;i++){
          checkBox[i].checked = this.checked
          console.log(checkBox[i].checked);
        }
      }
     
      //  设置已处理任务
      complete.onclick = function(){
        console.log(checkBox.length);
        for(let i = 0; i < checkBox.length; i++){
          console.log(checkBox.length);
          console.log(checkBox[i].checked);
          if(checkBox[i].checked){
            let complete_ipt = document.createElement('div')
            complete_ipt.className = 'complete_ipt'
            complete_ipt.innerHTML = taskName[i].value
            completeList.appendChild(complete_ipt)
            taskList.removeChild(taskbar[i])
          }
        }
      }
    //  设置获取焦点状态
      function focus(oTask){
        for (let i = 0; i < oTask.length; i++) {
          oTask[i].onfocus = function(){
            oTask[i].classList.remove('hide')
          }
          oTask[i].onblur = function(){
            oTask[i].className = 'taskName hide'
          }
        }
      }
    // 判断是否全选
      function isSelectAll(){
        var flag = true;
        for(let j = 0;j<checkBox.length;j++){
          if(!checkBox[j].checked){
            flag = false
          }
        }
        
        selectAll.checked = flag
      }
    </script>
  </body>
</html>
